(()=>{var e={};e.id=674,e.ids=[674],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},8791:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},8172:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>p,tree:()=>c}),s(7459),s(1266),s(4514),s(5866);var r=s(3191),a=s(8716),i=s(7922),n=s.n(i),d=s(5231),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);s.d(t,l);let c=["",{children:["admin",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7459)),"D:\\servaan\\src\\admin\\frontend\\src\\app\\admin\\users\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1266)),"D:\\servaan\\src\\admin\\frontend\\src\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,4514)),"D:\\servaan\\src\\admin\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],o=["D:\\servaan\\src\\admin\\frontend\\src\\app\\admin\\users\\page.tsx"],m="/admin/users/page",x={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/users/page",pathname:"/admin/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},507:(e,t,s)=>{Promise.resolve().then(s.bind(s,3989))},361:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(2881).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9669:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(2881).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},9015:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(2881).Z)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},3855:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(2881).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},9508:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(2881).Z)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},3989:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var r=s(326),a=s(7577),i=s(4066),n=s(7667);let d=async e=>{let t=new URLSearchParams;return t.append("page",String(e.page)),t.append("limit",String(e.limit)),e.search&&t.append("search",e.search),e.role&&t.append("role",e.role),e.isActive&&t.append("isActive",e.isActive),(await n.ZP.get(`/admin/users?${t.toString()}`)).data.data},l=async(e,t,s)=>(await n.ZP.post("/admin/users",{email:e,password:t,role:s})).data.data,c=async(e,t)=>(await n.ZP.put(`/admin/users/${encodeURIComponent(e)}/role`,{role:t})).data.data,o=async(e,t)=>(await n.ZP.put(`/admin/users/${encodeURIComponent(e)}/active`,{isActive:t})).data.data,m=async(e,t)=>(await n.ZP.post(`/admin/users/${encodeURIComponent(e)}/reset-password`,{newPassword:t})).data;var x=s(165),p=s(3855),u=s(8307),h=s(361),g=s(9669),b=s(9508),v=s(9015),y=s(2881);let j=(0,y.Z)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),f=(0,y.Z)("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);var N=s(381);let w=(0,i.c2)(function(){let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)(!0),[n,y]=(0,a.useState)(""),[w,P]=(0,a.useState)("ALL"),[k,Z]=(0,a.useState)("all"),[S,A]=(0,a.useState)(1),[q,E]=(0,a.useState)(10),[R,M]=(0,a.useState)(0),[_,C]=(0,a.useState)(0),D=(0,a.useCallback)(async()=>{try{i(!0);let e=await d({page:S,limit:q,search:n,role:w,isActive:k});t(e.users),M(e.pagination.total),C(e.pagination.pages)}catch(t){let e=t instanceof Error?t.message:"خطا در بارگذاری کاربران";N.ZP.error(e)}finally{i(!1)}},[S,q,n,w,k]),L=async()=>{let e=prompt("ایمیل کاربر جدید را وارد کنید");if(!e)return;let t=prompt("رمز عبور اولیه را وارد کنید (حداقل 8 کاراکتر)");if(!t)return;let s=prompt("نقش کاربر: SUPER_ADMIN | PLATFORM_ADMIN | SUPPORT | DEVELOPER","SUPPORT")||"SUPPORT";try{await l(e,t,s),N.ZP.success("کاربر ایجاد شد"),D()}catch(e){N.ZP.error(e instanceof Error?e.message:"خطا در ایجاد کاربر")}},O=async e=>{try{await o(e.id,!e.isActive),N.ZP.success(e.isActive?"غیرفعال شد":"فعال شد"),D()}catch(e){N.ZP.error(e instanceof Error?e.message:"خطا در تغییر وضعیت")}},[U,T]=(0,a.useState)(()=>({open:!1,role:"SUPPORT"})),I=e=>T({open:!0,user:e,role:e.role}),z=()=>T({open:!1,user:void 0,role:"SUPPORT"}),V=async()=>{if(U.user)try{await c(U.user.id,U.role),N.ZP.success("نقش کاربر به‌روزرسانی شد"),z(),D()}catch(e){N.ZP.error(e instanceof Error?e.message:"خطا در تغییر نقش")}},$=async e=>{let t=prompt("رمز عبور جدید را وارد کنید");if(t)try{await m(e.id,t),N.ZP.success("رمز عبور بازنشانی شد")}catch(e){N.ZP.error(e instanceof Error?e.message:"خطا در بازنشانی رمز عبور")}};return(0,r.jsxs)("div",{className:"min-h-screen bg-admin-bg",dir:"rtl",children:[r.jsx("div",{className:"bg-white border-b border-admin-border px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"h-8 w-8 bg-admin-primary rounded-lg flex items-center justify-center mr-3",children:r.jsx(x.Z,{className:"h-5 w-5 text-white"})}),(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-admin-text",children:"مدیریت کاربران ادمین"}),r.jsx("p",{className:"text-admin-text-light",children:"ایجاد، نقش‌ها و وضعیت حساب"})]})]}),r.jsx("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("button",{onClick:L,className:"btn-admin-primary flex items-center",children:[r.jsx(p.Z,{className:"h-4 w-4 ml-2"}),"کاربر جدید"]})})]})}),(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("div",{className:"bg-white rounded-admin border border-admin-border p-4 mb-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"relative",children:[r.jsx(u.Z,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-admin-text-muted"}),r.jsx("input",{value:n,onChange:e=>y(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(A(1),D())},placeholder:"جستجو ایمیل",className:"w-full pl-10 pr-4 py-2 border border-admin-border rounded-admin focus:ring-2 focus:ring-admin-primary"})]}),(0,r.jsxs)("select",{value:w,onChange:e=>{P(e.target.value),A(1)},className:"px-3 py-2 border border-admin-border rounded-admin",children:[r.jsx("option",{value:"ALL",children:"همه نقش‌ها"}),r.jsx("option",{value:"SUPER_ADMIN",children:"سوپر ادمین"}),r.jsx("option",{value:"PLATFORM_ADMIN",children:"پلتفرم ادمین"}),r.jsx("option",{value:"SUPPORT",children:"پشتیبانی"}),r.jsx("option",{value:"DEVELOPER",children:"توسعه‌دهنده"})]}),(0,r.jsxs)("select",{value:k,onChange:e=>{Z(e.target.value),A(1)},className:"px-3 py-2 border border-admin-border rounded-admin",children:[r.jsx("option",{value:"all",children:"همه وضعیت‌ها"}),r.jsx("option",{value:"true",children:"فعال"}),r.jsx("option",{value:"false",children:"غیرفعال"})]}),(0,r.jsxs)("select",{value:q,onChange:e=>{E(Number(e.target.value)),A(1)},className:"px-3 py-2 border border-admin-border rounded-admin",children:[r.jsx("option",{value:10,children:"۱۰"}),r.jsx("option",{value:25,children:"۲۵"}),r.jsx("option",{value:50,children:"۵۰"})]})]})}),r.jsx("div",{className:"bg-white rounded-admin border border-admin-border overflow-hidden",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-admin-border",children:[r.jsx("thead",{className:"bg-admin-bg",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-admin-text-muted uppercase tracking-wider",children:"ایمیل"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-admin-text-muted uppercase tracking-wider",children:"نقش"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-admin-text-muted uppercase tracking-wider",children:"وضعیت"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-admin-text-muted uppercase tracking-wider",children:"آخرین ورود"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-admin-text-muted uppercase tracking-wider",children:"عملیات"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-admin-border",children:s?r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-6 py-6 text-center",children:"در حال بارگذاری..."})}):0===e.length?r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-6 py-6 text-center text-admin-text-muted",children:"کاربری یافت نشد"})}):e.map(e=>(0,r.jsxs)("tr",{children:[r.jsx("td",{className:"px-6 py-3 text-sm font-mono",children:e.email}),r.jsx("td",{className:"px-6 py-3 text-sm",children:e.role}),r.jsx("td",{className:"px-6 py-3 text-sm",children:e.isActive?(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-admin-success text-white",children:[r.jsx(h.Z,{className:"h-3 w-3 ml-1"}),"فعال"]}):(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-admin-danger text-white",children:[r.jsx(g.Z,{className:"h-3 w-3 ml-1"}),"غیرفعال"]})}),r.jsx("td",{className:"px-6 py-3 text-sm",children:e.lastLogin?new Date(e.lastLogin).toLocaleString("fa-IR"):"—"}),r.jsx("td",{className:"px-6 py-3 text-sm",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("button",{className:"text-admin-warning hover:text-admin-warning-dark",title:"تغییر نقش",onClick:()=>I(e),children:r.jsx(b.Z,{className:"h-4 w-4"})}),r.jsx("button",{className:`${e.isActive?"text-admin-danger":"text-admin-success"} hover:opacity-80`,title:e.isActive?"غیرفعال‌سازی":"فعال‌سازی",onClick:()=>O(e),children:e.isActive?r.jsx(v.Z,{className:"h-4 w-4"}):r.jsx(j,{className:"h-4 w-4"})}),r.jsx("button",{className:"text-admin-primary hover:text-admin-primary-dark",title:"بازنشانی رمز",onClick:()=>$(e),children:r.jsx(f,{className:"h-4 w-4"})})]})})]},e.id))})]})}),_>1&&(0,r.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm text-admin-text-muted",children:["نمایش ",(S-1)*q+1," تا ",Math.min(S*q,R)," از ",R]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{disabled:1===S,onClick:()=>A(S-1),className:"px-3 py-2 text-sm font-medium text-admin-text bg-white border border-admin-border rounded-admin hover:bg-admin-bg disabled:opacity-50",children:"قبلی"}),r.jsx("button",{disabled:S===_,onClick:()=>A(S+1),className:"px-3 py-2 text-sm font-medium text-admin-text bg-white border border-admin-border rounded-admin hover:bg-admin-bg disabled:opacity-50",children:"بعدی"})]})]})]}),U.open&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-admin shadow-xl max-w-sm w-full",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-admin-border",children:[r.jsx("h3",{className:"text-lg font-bold text-admin-text",children:"تغییر نقش کاربر"}),r.jsx("p",{className:"text-sm text-admin-text-light mt-1",children:U.user?.email})]}),(0,r.jsxs)("div",{className:"p-4 space-y-3",children:[r.jsx("label",{className:"block text-sm text-admin-text",children:"نقش"}),(0,r.jsxs)("select",{value:U.role,onChange:e=>T(t=>({...t,role:e.target.value})),className:"w-full px-3 py-2 border border-admin-border rounded-admin",children:[r.jsx("option",{value:"SUPER_ADMIN",children:"سوپر ادمین"}),r.jsx("option",{value:"PLATFORM_ADMIN",children:"پلتفرم ادمین"}),r.jsx("option",{value:"SUPPORT",children:"پشتیبانی"}),r.jsx("option",{value:"DEVELOPER",children:"توسعه‌دهنده"})]})]}),(0,r.jsxs)("div",{className:"p-4 border-t border-admin-border flex items-center justify-end gap-2",children:[r.jsx("button",{className:"btn-admin-secondary",onClick:z,children:"انصراف"}),r.jsx("button",{className:"btn-admin-primary",onClick:V,children:"ذخیره"})]})]})})]})})},7459:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`D:\servaan\src\admin\frontend\src\app\admin\users\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[410,554,599],()=>s(8172));module.exports=r})();