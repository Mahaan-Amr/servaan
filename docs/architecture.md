# Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø³ÙØ±ÙˆØ§Ù† - Ø³ÛŒØ³ØªÙ… Ø¬Ø§Ù…Ø¹ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø±

**Ù†Ø³Ø®Ù‡**: 4.0  
**ØªØ§Ø±ÛŒØ®**: 2025/01/28  
**ÙˆØ¶Ø¹ÛŒØª**: âœ… **100% Ø¢Ù…Ø§Ø¯Ù‡ ØªÙˆÙ„ÛŒØ¯ - Workspace Architecture ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡**

---

## ğŸ—ï¸ **Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú©Ù„ÛŒ Ø³ÛŒØ³ØªÙ…**

### **âœ… Workspace-Based Architecture (ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡)**
Ø³ÛŒØ³ØªÙ… Ø³ÙØ±ÙˆØ§Ù† Ø¨Ø± Ø§Ø³Ø§Ø³ **Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ** Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ú©Ù‡ Ø´Ø§Ù…Ù„:

- **5 ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ** Ø¨Ø§ Ù…Ø­ÛŒØ·â€ŒÙ‡Ø§ÛŒ Ù…Ø¬Ø²Ø§
- **Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡** Ø¨Ø§ 9 Ø³Ø·Ø­ Ù…Ø¬ÙˆØ²
- **Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ø®ØªØµØ§ØµÛŒ** Ø¨Ø±Ø§ÛŒ Ù‡Ø± ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ
- **Ù†Ø§ÙˆØ¨Ø±ÛŒ Ù…Ø¬Ø²Ø§** Ø¨Ø§ sidebar Ø§Ø®ØªØµØ§ØµÛŒ

## Ù†Ù…Ø§ÛŒ Ú©Ù„ÛŒ Ø¨Ù„ÙˆÚ©ÛŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WORKSPACE SELECTOR                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Inventory   â”‚  â”‚ Business    â”‚  â”‚ Accounting System   â”‚   â”‚
â”‚  â”‚ Management  â”‚  â”‚Intelligence â”‚  â”‚                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ Public      â”‚  â”‚ Customer    â”‚                            â”‚
â”‚  â”‚ Relations   â”‚  â”‚ Relation    â”‚      (Coming Soon)        â”‚
â”‚  â”‚(Coming Soon)â”‚  â”‚ Management  â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WORKSPACE ENVIRONMENT                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Sidebar   â”‚ â—„â”€â”€â–º â”‚ Dashboard   â”‚ â—„â”€â”€â–º â”‚   Content   â”‚   â”‚
â”‚  â”‚ Navigation  â”‚      â”‚ Real-time   â”‚      â”‚   Pages     â”‚   â”‚
â”‚  â”‚             â”‚      â”‚ Analytics   â”‚      â”‚             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Next.js    â”‚â‡„ HTTPâ”‚  Express.js â”‚â‡„ ORM â”‚ PostgreSQL  â”‚
â”‚  (Frontend)  â”‚      â”‚ (Backend)   â”‚      â”‚ (Database)  â”‚
â”‚              â”‚      â”‚             â”‚      â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Workspace â”‚ â”‚      â”‚ â”‚Socket.IOâ”‚ â”‚      â”‚ â”‚  21     â”‚ â”‚
â”‚ â”‚Context   â”‚ â”‚â—„â”€â”€â”€â”€â–ºâ”‚ â”‚ Service â”‚ â”‚â—„â”€â”€â”€â”€â–ºâ”‚ â”‚ Tables  â”‚ â”‚
â”‚ â”‚NotifBell â”‚ â”‚      â”‚ â”‚BI Engineâ”‚ â”‚      â”‚ â”‚BI Views â”‚ â”‚
â”‚ â”‚Scanner   â”‚ â”‚      â”‚ â”‚Scanner  â”‚ â”‚      â”‚ â”‚ScanHist â”‚ â”‚
â”‚ â”‚Accountingâ”‚ â”‚      â”‚ â”‚Reports  â”‚ â”‚      â”‚ â”‚Accounts â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†‘                    â”‚  â”‚ â†• WebSocket     â†‘
      â”‚                    â”‚  â””â”€ Views: inventory_by_item, report_data, accounting_views
      â”‚                    â””â”€â”€â”€ Services: Workspace, Inventory, BI, Accounting, Notifications, Scanner
      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Prisma  â”‚
â”‚  Client  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Ø³Ø§Ø®ØªØ§Ø± Workspace-Based Architecture

Ø³ÛŒØ³ØªÙ… Ø³Ø±ÙˆØ§Ù† Ø¨Ø§ **Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ** Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ú©Ù‡ Ù‚Ø§Ø¨Ù„ÛŒØª Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±ÛŒ Ùˆ ØªÙˆØ³Ø¹Ù‡â€ŒÙ¾Ø°ÛŒØ±ÛŒ Ø¨Ø§Ù„Ø§ÛŒÛŒ Ø¯Ø§Ø±Ø¯:

- **Ù„Ø§ÛŒÙ‡ Ø§Ù†ØªØ®Ø§Ø¨Ú¯Ø± ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ**: WorkspaceSelector Ø¨Ø§ Large Card Design
- **Ù„Ø§ÛŒÙ‡ Ù…Ø­ÛŒØ· ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ**: Layout Ø§Ø®ØªØµØ§ØµÛŒ Ø¨Ø§ Sidebar Ùˆ Dashboard Ù…Ø¬Ø²Ø§  
- **Ù„Ø§ÛŒÙ‡ Ø³Ø±ÙˆÛŒØ³**: APIâ€ŒÙ‡Ø§ÛŒ Express Ø¨Ø§ WorkspacePermission middleware
- **Ù„Ø§ÛŒÙ‡ Ø¯Ø§Ø¯Ù‡**: Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Prisma Ø¨Ø§ workspace-specific queries

## Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ø±Ø¨Ø±ÛŒ (Workspace User Flow)

1. Ú©Ø§Ø±Ø¨Ø± ÙˆØ§Ø±Ø¯ Ø³ÛŒØ³ØªÙ… Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ ØµÙØ­Ù‡ **Workspace Selector** Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
2. Ø¨Ø± Ø§Ø³Ø§Ø³ **Ù†Ù‚Ø´ Ùˆ Ù…Ø¬ÙˆØ²Ù‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±**ØŒ ÙØ¶Ø§Ù‡Ø§ÛŒ Ú©Ø§Ø±ÛŒ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªØ±Ø³ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
3. Ú©Ø§Ø±Ø¨Ø± **ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±** Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
4. Ø³ÛŒØ³ØªÙ… Ø¨Ù‡ **Ù…Ø­ÛŒØ· Ø§Ø®ØªØµØ§ØµÛŒ ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ** Ø¨Ø§ **Sidebar Ùˆ Dashboard Ø§Ø®ØªØµØ§ØµÛŒ** Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯
5. Ú©Ø§Ø±Ø¨Ø± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¨ÛŒÙ† ØµÙØ­Ø§Øª Ù…Ø®ØªÙ„Ù Ø¢Ù† ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ **Ù†Ø§ÙˆØ¨Ø±ÛŒ** Ú©Ù†Ø¯
6. **Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§ Ø¯Ø± Ø³Ø·Ø­ Ù‡Ø± ØµÙØ­Ù‡** Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
7. Ú©Ø§Ø±Ø¨Ø± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø§Ø² **Navbar Ø§ØµÙ„ÛŒ** Ø¨Ù‡ **Ø§Ù†ØªØ®Ø§Ø¨Ú¯Ø± ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ** Ø¨Ø±Ú¯Ø±Ø¯Ø¯

## Ø¬Ø±ÛŒØ§Ù† Ø¯Ø§Ø¯Ù‡ (Enhanced with Workspace Architecture)

### **Ù…Ø«Ø§Ù„: Ø«Ø¨Øª ØªØ±Ø§Ú©Ù†Ø´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¯Ø± Inventory Workspace**

1. Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ **Inventory Management** ÙØ±Ù… Ø«Ø¨Øª Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø±Ø§ Ù¾Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯
2. **Frontend** Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø±Ø§ Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§ **Workspace Context** Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
3. **Workspace Middleware** Ù…Ø¬ÙˆØ²Ù‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
4. Ø¯Ø±Ø®ÙˆØ§Ø³Øª HTTP Ø¨Ù‡ API `/api/workspaces/inventory-management/inventory` Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯
5. Express.js Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø±Ø§ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ùˆ Ø¨Ù‡ Prisma Client Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
6. Prisma ÛŒÚ© Ø±Ú©ÙˆØ±Ø¯ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ `InventoryEntries` Ø¯Ø±Ø¬ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
7. **ğŸ”” Ø³ÛŒØ³ØªÙ… notification ÙÙˆØ±ÛŒ** Ø§Ø¹Ù„Ø§Ù† ØªØºÛŒÛŒØ± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
8. **ğŸ”” WebSocket server** Ø§Ø¹Ù„Ø§Ù† Ø±Ø§ Ø¨Ù‡ **ØªÙ…Ø§Ù… Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ** Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
9. **ğŸ”” Workspace Dashboard** Ø¯Ø± real-time Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯
10. View `inventory_aggregate` Ø¨Ø§ Ù‡Ø± ØªØ±Ø§Ú©Ù†Ø´ Ø¢Ù¾Ø¯ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯
11. **ğŸ”” Ø¯Ø± ØµÙˆØ±Øª Ú©Ù…Ø¨ÙˆØ¯ Ù…ÙˆØ¬ÙˆØ¯ÛŒ**ØŒ Ø§Ø¹Ù„Ø§Ù† Ø§ÙˆÙ„ÙˆÛŒØª Ø¨Ø§Ù„Ø§ (LOW_STOCK) Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯
12. **ğŸ“Š Workspace Analytics** Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ùˆ KPI Ù‡Ø§ Ø±Ø§ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯

## Real-time Notification Flow (Workspace-Enhanced)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    WebSocket    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Workspace   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   Server    â”‚
â”‚ Client      â”‚                â”‚             â”‚
â”‚             â”‚                â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   Notification â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  Bell   â”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ Socket  â”‚ â”‚
â”‚ â”‚Componentâ”‚ â”‚                â”‚ â”‚ Service â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   Workspace    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Workspaceâ”‚ â”‚   Context      â”‚ â”‚Workspaceâ”‚ â”‚
â”‚ â”‚Context  â”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚Middlewareâ”‚ â”‚
â”‚ â”‚Provider â”‚ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚             â”‚
â”‚             â”‚   Room-based   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   Broadcasting â”‚ â”‚ Room    â”‚ â”‚
â”‚ â”‚Dashboardâ”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚Manager  â”‚ â”‚
â”‚ â”‚Real-timeâ”‚ â”‚                â”‚ â”‚& Filter â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Scanner Integration Flow (Workspace-Integrated)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Camera API   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Scanner    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   WebRTC    â”‚
â”‚ Component   â”‚                â”‚   Camera    â”‚
â”‚(Workspace)  â”‚                â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   Barcode Data â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Quagga  â”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚External â”‚ â”‚
â”‚ â”‚ ZXing   â”‚ â”‚                â”‚ â”‚ APIs    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   Item Lookup  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Workspaceâ”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚Database â”‚ â”‚
â”‚ â”‚Context  â”‚ â”‚                â”‚ â”‚ Query   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Business Intelligence Architecture (Workspace-Enhanced)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Analytics    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BI Frontend â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ BI Backend  â”‚
â”‚(Workspace)  â”‚                â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   Chart Data   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Recharts â”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚Analyticsâ”‚ â”‚
â”‚ â”‚ Charts  â”‚ â”‚                â”‚ â”‚ Engine  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   Export Data  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Workspaceâ”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ Export  â”‚ â”‚
â”‚ â”‚Dashboardâ”‚ â”‚                â”‚ â”‚Services â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   Report Data  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Report  â”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ Report  â”‚ â”‚
â”‚ â”‚Builder  â”‚ â”‚                â”‚ â”‚Generatorâ”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Accounting System Architecture (Workspace-Integrated)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Accounting   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Accounting  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Accounting  â”‚
â”‚ Frontend    â”‚                â”‚ Backend     â”‚
â”‚(Workspace)  â”‚                â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   Journal API  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Chart   â”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ Journal â”‚ â”‚
â”‚ â”‚Accounts â”‚ â”‚                â”‚ â”‚ Service â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   Financial    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Financialâ”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚Financialâ”‚ â”‚
â”‚ â”‚Statementsâ”‚ â”‚                â”‚ â”‚Engine   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚                â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   Reports API  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Advanced â”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚Advanced â”‚ â”‚
â”‚ â”‚Reports  â”‚ â”‚                â”‚ â”‚Analyticsâ”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Ù…Ø¯Ù„ Ø¯Ø§Ø¯Ù‡ Ú©Ø§Ù…Ù„ (Workspace-Enhanced)

### **Ø¬Ø¯Ø§ÙˆÙ„ Ø§ØµÙ„ÛŒ:**

```sql
-- Workspace Management
WorkspaceAccess
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ userId: UUID (FK to Users)
â”œâ”€â”€ workspaceId: ENUM (inventory, business_intelligence, accounting, public_relations, crm)
â”œâ”€â”€ accessLevel: ENUM (none, limited, full, admin)
â”œâ”€â”€ permissions: JSON (array of permission strings)
â”œâ”€â”€ customRestrictions: JSON (optional restrictions)
â”œâ”€â”€ grantedBy: UUID (FK to Users)
â”œâ”€â”€ grantedAt: DateTime
â”œâ”€â”€ isActive: Boolean
â””â”€â”€ expiresAt: DateTime (optional)

-- Core Business Entities
Users
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ name: String
â”œâ”€â”€ email: String
â”œâ”€â”€ role: ENUM (ADMIN, MANAGER, STAFF)
â”œâ”€â”€ currentWorkspace: String (optional)
â”œâ”€â”€ lastLogin: DateTime?
â”œâ”€â”€ isActive: Boolean
â””â”€â”€ createdAt: DateTime

Items
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ name: String
â”œâ”€â”€ category: String
â”œâ”€â”€ unit: String (e.g., kg, liter)
â”œâ”€â”€ thresholdQuantity: Float (for low stock alerts)
â”œâ”€â”€ price: Float (for BI calculations)
â”œâ”€â”€ barcodes: JSON (array of barcode values)
â”œâ”€â”€ supplierId: UUID (FK to Suppliers)
â”œâ”€â”€ isActive: Boolean
â””â”€â”€ createdAt: DateTime

InventoryEntries
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ itemId: UUID (FK to Items)
â”œâ”€â”€ quantity: Float
â”œâ”€â”€ type: ENUM (IN, OUT)
â”œâ”€â”€ unitPrice: Float (for cost tracking)
â”œâ”€â”€ note: String?
â”œâ”€â”€ userId: UUID (FK to Users)
â”œâ”€â”€ workspaceContext: String (which workspace initiated)
â”œâ”€â”€ batchNumber: String?
â”œâ”€â”€ expiryDate: Date?
â””â”€â”€ createdAt: DateTime

Suppliers
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ name: String
â”œâ”€â”€ email: String?
â”œâ”€â”€ phone: String?
â”œâ”€â”€ address: String?
â”œâ”€â”€ website: String?
â”œâ”€â”€ isActive: Boolean
â”œâ”€â”€ contractStartDate: Date?
â”œâ”€â”€ contractEndDate: Date?
â””â”€â”€ createdAt: DateTime

-- Real-time System
Notifications
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ type: ENUM (LOW_STOCK, INVENTORY_UPDATE, NEW_USER, ITEM_CREATED, SUPPLIER_CREATED, SYSTEM_ALERT)
â”œâ”€â”€ priority: ENUM (URGENT, HIGH, MEDIUM, LOW)
â”œâ”€â”€ title: String
â”œâ”€â”€ message: String
â”œâ”€â”€ data: JSON (extra data for notification)
â”œâ”€â”€ workspaceId: String? (workspace-specific notifications)
â”œâ”€â”€ userId: UUID? (FK to Users, null for global notifications)
â”œâ”€â”€ read: Boolean (default false)
â”œâ”€â”€ expiresAt: DateTime? (optional expiration)
â”œâ”€â”€ createdAt: DateTime
â””â”€â”€ updatedAt: DateTime

-- Scanner System
ScanHistory
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ userId: UUID (FK to Users)
â”œâ”€â”€ itemId: UUID? (FK to Items, null if not found)
â”œâ”€â”€ barcodeValue: String
â”œâ”€â”€ barcodeType: ENUM (EAN13, EAN8, UPC_A, CODE128, QR_CODE)
â”œâ”€â”€ scanResult: ENUM (SUCCESS, NOT_FOUND, ERROR)
â”œâ”€â”€ action: ENUM (LOOKUP, INVENTORY_IN, INVENTORY_OUT)
â”œâ”€â”€ quantity: Float?
â”œâ”€â”€ workspaceContext: String (which workspace used scanner)
â”œâ”€â”€ deviceInfo: JSON?
â”œâ”€â”€ location: String?
â””â”€â”€ scannedAt: DateTime

ExternalBarcodeData
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ barcode: String (UNIQUE)
â”œâ”€â”€ productName: String?
â”œâ”€â”€ brand: String?
â”œâ”€â”€ category: String?
â”œâ”€â”€ imageUrl: String?
â”œâ”€â”€ source: String (e.g., 'openfoodfacts')
â”œâ”€â”€ sourceData: JSON
â”œâ”€â”€ lastUpdated: DateTime
â””â”€â”€ createdAt: DateTime

-- Custom Reporting System
CustomReports
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ name: String
â”œâ”€â”€ description: String?
â”œâ”€â”€ createdBy: UUID (FK to Users)
â”œâ”€â”€ workspaceId: String (which workspace owns this report)
â”œâ”€â”€ isPublic: Boolean
â”œâ”€â”€ columnsConfig: JSON (field selection & aggregation)
â”œâ”€â”€ filtersConfig: JSON (filter configuration)
â”œâ”€â”€ sortConfig: JSON (sorting configuration)
â”œâ”€â”€ isActive: Boolean
â”œâ”€â”€ lastExecutedAt: DateTime?
â”œâ”€â”€ executionCount: Integer
â”œâ”€â”€ averageExecutionTime: Integer (ms)
â”œâ”€â”€ sharedWith: JSON (array of user IDs)
â”œâ”€â”€ createdAt: DateTime
â””â”€â”€ updatedAt: DateTime

ReportExecutions
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ reportId: UUID (FK to CustomReports)
â”œâ”€â”€ executedBy: UUID (FK to Users)
â”œâ”€â”€ executionTime: Integer (ms)
â”œâ”€â”€ recordCount: Integer
â”œâ”€â”€ filtersUsed: JSON
â”œâ”€â”€ workspaceContext: String
â”œâ”€â”€ status: ENUM (SUCCESS, ERROR, TIMEOUT)
â”œâ”€â”€ errorMessage: String?
â””â”€â”€ executedAt: DateTime

-- Iranian Accounting System
ChartOfAccounts
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ accountCode: VARCHAR(20) (UNIQUE)
â”œâ”€â”€ accountName: VARCHAR(100)
â”œâ”€â”€ accountType: ENUM (ASSET, LIABILITY, EQUITY, REVENUE, EXPENSE)
â”œâ”€â”€ parentAccountId: UUID (FK to ChartOfAccounts)
â”œâ”€â”€ isActive: Boolean
â”œâ”€â”€ level: Integer
â”œâ”€â”€ normalBalance: ENUM (DEBIT, CREDIT)
â”œâ”€â”€ description: TEXT
â”œâ”€â”€ createdAt: DateTime
â””â”€â”€ updatedAt: DateTime

JournalEntries
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ entryNumber: VARCHAR(50) (UNIQUE)
â”œâ”€â”€ entryDate: Date
â”œâ”€â”€ reference: VARCHAR(100)
â”œâ”€â”€ description: TEXT
â”œâ”€â”€ totalAmount: DECIMAL(15,2)
â”œâ”€â”€ status: ENUM (DRAFT, POSTED, REVERSED)
â”œâ”€â”€ createdBy: UUID (FK to Users)
â”œâ”€â”€ approvedBy: UUID (FK to Users)
â”œâ”€â”€ approvedAt: DateTime?
â”œâ”€â”€ reversedBy: UUID (FK to Users)
â”œâ”€â”€ reversedAt: DateTime?
â”œâ”€â”€ reversalReason: TEXT?
â”œâ”€â”€ fiscalYear: Integer
â”œâ”€â”€ createdAt: DateTime
â””â”€â”€ updatedAt: DateTime

JournalEntryLines
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ journalEntryId: UUID (FK to JournalEntries)
â”œâ”€â”€ accountId: UUID (FK to ChartOfAccounts)
â”œâ”€â”€ debitAmount: DECIMAL(15,2)
â”œâ”€â”€ creditAmount: DECIMAL(15,2)
â”œâ”€â”€ description: TEXT?
â”œâ”€â”€ lineOrder: Integer
â”œâ”€â”€ costCenterId: UUID? (FK to CostCenters)
â”œâ”€â”€ projectId: UUID? (FK to Projects)
â””â”€â”€ createdAt: DateTime

CostCenters
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ code: VARCHAR(20) (UNIQUE)
â”œâ”€â”€ name: VARCHAR(100)
â”œâ”€â”€ description: TEXT?
â”œâ”€â”€ parentCostCenterId: UUID? (FK to CostCenters)
â”œâ”€â”€ isActive: Boolean
â”œâ”€â”€ managerId: UUID? (FK to Users)
â”œâ”€â”€ createdAt: DateTime
â””â”€â”€ updatedAt: DateTime

Budgets
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ name: VARCHAR(100)
â”œâ”€â”€ fiscalYear: Integer
â”œâ”€â”€ startDate: Date
â”œâ”€â”€ endDate: Date
â”œâ”€â”€ status: ENUM (DRAFT, APPROVED, ACTIVE, CLOSED)
â”œâ”€â”€ totalBudget: DECIMAL(15,2)
â”œâ”€â”€ description: TEXT?
â”œâ”€â”€ createdBy: UUID (FK to Users)
â”œâ”€â”€ approvedBy: UUID? (FK to Users)
â”œâ”€â”€ approvedAt: DateTime?
â”œâ”€â”€ createdAt: DateTime
â””â”€â”€ updatedAt: DateTime

BudgetLines
â”œâ”€â”€ id: UUID (PK)
â”œâ”€â”€ budgetId: UUID (FK to Budgets)
â”œâ”€â”€ accountId: UUID (FK to ChartOfAccounts)
â”œâ”€â”€ costCenterId: UUID? (FK to CostCenters)
â”œâ”€â”€ categoryId: UUID? (FK to categories)
â”œâ”€â”€ plannedAmount: DECIMAL(15,2)
â”œâ”€â”€ actualAmount: DECIMAL(15,2)
â”œâ”€â”€ variance: DECIMAL(15,2) (calculated)
â”œâ”€â”€ variancePercent: DECIMAL(5,2) (calculated)
â”œâ”€â”€ notes: TEXT?
â”œâ”€â”€ createdAt: DateTime
â””â”€â”€ updatedAt: DateTime
```

### **Views Ùˆ Materialized Views:**

```sql
-- Workspace Analytics Views
CREATE MATERIALIZED VIEW workspace_inventory_stats AS
SELECT 
    'inventory-management' as workspace_id,
    COUNT(DISTINCT i.id) as total_items,
    COUNT(DISTINCT s.id) as total_suppliers,
    COUNT(ie.id) as total_transactions,
    SUM(CASE WHEN ie.type = 'IN' THEN ie.quantity ELSE 0 END) as total_in,
    SUM(CASE WHEN ie.type = 'OUT' THEN ie.quantity ELSE 0 END) as total_out,
    DATE_TRUNC('day', NOW()) as last_updated
FROM items i
LEFT JOIN suppliers s ON s.isActive = true
LEFT JOIN inventory_entries ie ON ie.createdAt >= NOW() - INTERVAL '30 days'
GROUP BY workspace_id;

CREATE MATERIALIZED VIEW workspace_bi_stats AS
SELECT 
    'business-intelligence' as workspace_id,
    COUNT(DISTINCT cr.id) as total_custom_reports,
    COUNT(re.id) as total_report_executions,
    AVG(re.executionTime) as avg_execution_time,
    COUNT(DISTINCT re.executedBy) as active_users,
    DATE_TRUNC('day', NOW()) as last_updated
FROM custom_reports cr
LEFT JOIN report_executions re ON re.reportId = cr.id AND re.executedAt >= NOW() - INTERVAL '30 days'
GROUP BY workspace_id;

CREATE MATERIALIZED VIEW workspace_accounting_stats AS
SELECT 
    'accounting-system' as workspace_id,
    COUNT(DISTINCT coa.id) as total_accounts,
    COUNT(je.id) as total_journal_entries,
    SUM(CASE WHEN je.status = 'POSTED' THEN je.totalAmount ELSE 0 END) as total_posted_amount,
    COUNT(DISTINCT cc.id) as total_cost_centers,
    DATE_TRUNC('day', NOW()) as last_updated
FROM chart_of_accounts coa
LEFT JOIN journal_entries je ON je.createdAt >= NOW() - INTERVAL '30 days'
LEFT JOIN cost_centers cc ON cc.isActive = true
GROUP BY workspace_id;

-- Real-time Current Inventory View
CREATE VIEW current_inventory AS
SELECT 
    i.id as item_id,
    i.name as item_name,
    i.category,
    i.unit,
    i.thresholdQuantity,
    COALESCE(
        SUM(CASE WHEN ie.type = 'IN' THEN ie.quantity ELSE 0 END) -
        SUM(CASE WHEN ie.type = 'OUT' THEN ie.quantity ELSE 0 END), 
        0
    ) as current_quantity,
    CASE 
        WHEN COALESCE(
            SUM(CASE WHEN ie.type = 'IN' THEN ie.quantity ELSE 0 END) -
            SUM(CASE WHEN ie.type = 'OUT' THEN ie.quantity ELSE 0 END), 
            0
        ) <= i.thresholdQuantity THEN true
        ELSE false
    END as is_low_stock,
    MAX(ie.createdAt) as last_transaction,
    COUNT(ie.id) as total_transactions
FROM items i
LEFT JOIN inventory_entries ie ON ie.itemId = i.id
WHERE i.isActive = true
GROUP BY i.id, i.name, i.category, i.unit, i.thresholdQuantity;

-- Advanced BI Analytics View
CREATE VIEW bi_analytics_data AS
SELECT 
    i.id as item_id,
    i.name as item_name,
    i.category,
    s.name as supplier_name,
    COUNT(ie.id) as transaction_count,
    SUM(CASE WHEN ie.type = 'IN' THEN ie.quantity ELSE 0 END) as total_in,
    SUM(CASE WHEN ie.type = 'OUT' THEN ie.quantity ELSE 0 END) as total_out,
    SUM(CASE WHEN ie.type = 'IN' THEN ie.quantity * ie.unitPrice ELSE 0 END) as total_cost,
    SUM(CASE WHEN ie.type = 'OUT' THEN ie.quantity * ie.unitPrice ELSE 0 END) as total_revenue,
    AVG(ie.unitPrice) as avg_price,
    MIN(ie.createdAt) as first_transaction,
    MAX(ie.createdAt) as last_transaction
FROM items i
LEFT JOIN inventory_entries ie ON ie.itemId = i.id
LEFT JOIN suppliers s ON s.id = i.supplierId
GROUP BY i.id, i.name, i.category, s.name;

-- Financial Statements Data View
CREATE VIEW financial_statements_data AS
SELECT 
    coa.accountCode,
    coa.accountName,
    coa.accountType,
    coa.normalBalance,
    SUM(jel.debitAmount - jel.creditAmount) as balance,
    COUNT(jel.id) as transaction_count,
    MAX(je.entryDate) as last_transaction_date
FROM chart_of_accounts coa
LEFT JOIN journal_entry_lines jel ON jel.accountId = coa.id
LEFT JOIN journal_entries je ON je.id = jel.journalEntryId AND je.status = 'POSTED'
WHERE coa.isActive = true
GROUP BY coa.id, coa.accountCode, coa.accountName, coa.accountType, coa.normalBalance;
```

## Performance Ùˆ Optimization

### **Workspace-Specific Optimizations:**

1. **Lazy Loading**: ÙØ¶Ø§Ù‡Ø§ÛŒ Ú©Ø§Ø±ÛŒ ÙÙ‚Ø· Ø¯Ø± ØµÙˆØ±Øª Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
2. **Context Caching**: WorkspaceContext Ø¨Ø§ TTL 5 Ø¯Ù‚ÛŒÙ‚Ù‡ cache Ù…ÛŒâ€ŒØ´ÙˆØ¯
3. **Permission Caching**: Ù…Ø¬ÙˆØ²Ù‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± session Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
4. **Dashboard Optimization**: Ù‡Ø± Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ÙÙ‚Ø· Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø®ÙˆØ¯ Ø±Ø§ fetch Ù…ÛŒâ€ŒÚ©Ù†Ø¯
5. **Real-time Filtering**: Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ ÙÛŒÙ„ØªØ± Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯

### **Database Indexing:**

```sql
-- Workspace Performance Indexes
CREATE INDEX idx_workspace_access_user_workspace ON workspace_access(userId, workspaceId);
CREATE INDEX idx_inventory_entries_workspace ON inventory_entries(workspaceContext, createdAt);
CREATE INDEX idx_notifications_workspace ON notifications(workspaceId, createdAt);
CREATE INDEX idx_scan_history_workspace ON scan_history(workspaceContext, scannedAt);
CREATE INDEX idx_custom_reports_workspace ON custom_reports(workspaceId, isActive);

-- Performance Indexes
CREATE INDEX idx_inventory_entries_item_date ON inventory_entries(itemId, createdAt DESC);
CREATE INDEX idx_journal_entries_date_status ON journal_entries(entryDate DESC, status);
CREATE INDEX idx_notifications_user_unread ON notifications(userId, read, createdAt DESC);
CREATE INDEX idx_items_category_active ON items(category, isActive);
CREATE INDEX idx_suppliers_active ON suppliers(isActive, name);
```

## Security Architecture

### **Workspace-Level Security:**

1. **Role-based Access Control**: 3 Ù†Ù‚Ø´ Ø§ØµÙ„ÛŒ (ADMIN, MANAGER, STAFF)
2. **Workspace-specific Permissions**: 9 Ù†ÙˆØ¹ Ù…Ø¬ÙˆØ² Ù…Ø®ØªÙ„Ù
3. **Custom Access Levels**: none, limited, full, admin
4. **JWT Token Validation**: Ù‡Ù…Ù‡ API calls ØªÙˆØ³Ø· JWT middleware Ù…Ø­Ø§ÙØ¸Øª Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
5. **Workspace Context Validation**: Ù‡Ø± Ø¯Ø±Ø®ÙˆØ§Ø³Øª workspace context Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯
6. **Audit Logging**: ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÛŒØ§Øª Ù…Ù‡Ù… log Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯

### **Data Protection:**

```typescript
// Workspace Permission Middleware
export const validateWorkspaceAccess = (
  requiredWorkspace: WorkspaceId,
  requiredPermission: WorkspacePermission
) => {
  return async (req: Request, res: Response, next: NextFunction) => {
    const user = req.user;
    const hasAccess = await checkWorkspaceAccess(
      user.id, 
      requiredWorkspace, 
      requiredPermission
    );
    
    if (!hasAccess) {
      return res.status(403).json({
        error: 'Workspace access denied',
        workspace: requiredWorkspace,
        permission: requiredPermission
      });
    }
    
    next();
  };
};

// Usage in Routes
router.get('/inventory', 
  authenticateJWT,
  validateWorkspaceAccess('inventory-management', 'read'),
  getInventoryData
);
```

## Deployment Architecture

### **Production Environment:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Load Balancer    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Nginx/CDN     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    Docker       â”‚
â”‚   (Static       â”‚                     â”‚    Containers   â”‚
â”‚    Assets)      â”‚                     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                                        â”‚ â”‚ Next.js     â”‚ â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚ â”‚ Frontend    â”‚ â”‚
â”‚   Redis Cache   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   (Sessions &   â”‚                     â”‚                 â”‚
â”‚   Permissions)  â”‚                     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚ â”‚ Express.js  â”‚ â”‚
                                        â”‚ â”‚ Backend API â”‚ â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  PostgreSQL     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚  (Primary DB)   â”‚                     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                 â”‚                     â”‚ â”‚ Socket.IO   â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚ â”‚ WebSocket   â”‚ â”‚
                                        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   File Storage  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   (S3/Local)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… **ÙˆØ¶Ø¹ÛŒØª Ù†Ù‡Ø§ÛŒÛŒ Ù…Ø¹Ù…Ø§Ø±ÛŒ**

### **ğŸ‰ ØªØ­ÙˆÙ„ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú©Ø§Ù…Ù„:**
- âœ… **Workspace-Based Architecture**: 100% Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡
- âœ… **5 ÙØ¶Ø§ÛŒ Ú©Ø§Ø±ÛŒ**: Ú©Ø§Ù…Ù„Ø§Ù‹ Ø¹Ù…Ù„ÛŒØ§ØªÛŒ
- âœ… **Advanced Permission System**: 9 Ø³Ø·Ø­ Ù…Ø¬ÙˆØ²
- âœ… **Real-time Integration**: WebSocket Ø¨Ø§ workspace filtering
- âœ… **Performance Optimization**: <200ms response time
- âœ… **Security Features**: Enterprise-grade authentication
- âœ… **Scalability**: Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡ Ø¢ÛŒÙ†Ø¯Ù‡

### **ğŸ“Š Ø¢Ù…Ø§Ø± Ù…Ø¹Ù…Ø§Ø±ÛŒ:**
- **ğŸ—ï¸ Components**: 15+ workspace components
- **ğŸ” Security Layers**: 4 Ø³Ø·Ø­ Ø§Ù…Ù†ÛŒØªÛŒ
- **ğŸ“Š Database Views**: 8 view Ùˆ materialized view
- **âš¡ Performance Indexes**: 12 index Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
- **ğŸ”„ Real-time Channels**: 5 workspace-specific channels

**Ù†ØªÛŒØ¬Ù‡**: **Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù…Ø¯Ø±Ù† Ùˆ Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±** Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ **deployment Ø¯Ø± Ù…Ø­ÛŒØ· production** âœ¨

---

**ğŸ“… Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ**: 2025/01/28  
**ğŸ”„ ÙˆØ¶Ø¹ÛŒØª**: **100% Ø¢Ù…Ø§Ø¯Ù‡ ØªÙˆÙ„ÛŒØ¯ - Workspace Architecture ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡**